(this.webpackJsonpxwords=this.webpackJsonpxwords||[]).push([[0],{58:function(e,t,n){},59:function(e,t,n){},74:function(e,t){},76:function(e,t){},86:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n(1),c=n.n(s),i=n(49),o=n.n(i),u=(n(58),n(3)),a=(n(59),n(50)),l=n.n(a),h=n(51),d=n(52);function f(e,t,n,r){var s=e[t][0].$,c=(parseInt(s.n)-1)/n>>0,i=(parseInt(s.n)-1)%n;return s.row=c,s.col=i,s}var j=function(){function e(t){var n=this;Object(h.a)(this,e),this.reference=[],this.guesses=[],this.clueMap=[],this.width=0,this.height=0,this.cursorX=0,this.cursorY=0,this.direction=0,this.cluesDown={},this.cluesAcross={},this.corrects=0,this.total=0,this.title="",t=t.crossword,this.title=t.Title[0].$.v,this.width=parseInt(t.Width[0].$.v||0),this.height=parseInt(t.Height[0].$.v||0);var r=Object.keys(t.across[0]).map((function(e){return f(t.across[0],e,n.width,n.height)})),s=Object.keys(t.down[0]).map((function(e){return f(t.down[0],e,n.width,n.height)}));s.forEach((function(e){n.cluesDown[e.cn]=e})),r.forEach((function(e){n.cluesAcross[e.cn]=e}));for(var c=0;c<this.height;c++){for(var i=[],o=0;o<this.width;o++)i.push(null);this.guesses.push([].concat(i)),this.reference.push([].concat(i)),this.clueMap.push([].concat(i))}var u={row:r[0].row,col:r[0].col};this.cursorX=u.col,this.cursorY=u.row;for(var a=0;a<r.length;a++)for(var l=r[a],d=l.row,j=l.col,v=0;v<l.a.length;v++)this.reference[d][j+v]=l.a[v],this.clueMap[d][j+v]={across:{index:l.cn,isStart:0===v}},this.guesses[d][j+v]="",this.total++;s.forEach((function(e){for(var t=0;t<e.a.length;t++)n.clueMap[e.row+t][e.col].down={index:e.cn,isStart:0===t}}))}return Object(d.a)(e,[{key:"setCursor",value:function(e,t){return e<this.width&&e>=0&&t<this.height&&t>=0&&(this.cursorX=e,this.cursorY=t),{x:this.cursorX,y:this.cursorY}}},{key:"_movement",value:function(e){var t=this.cursorX,n=this.cursorY;do{var r=e(t,n);t=r.x,n=r.y}while(t<this.width&&n<this.height&&t>=0&&n>=0&&null===this.reference[n][t]);return this.setCursor(t,n)}},{key:"right",value:function(){return this._movement((function(e,t){return{x:e+1,y:t}}))}},{key:"down",value:function(){return this._movement((function(e,t){return{x:e,y:t+1}}))}},{key:"up",value:function(){return this._movement((function(e,t){return{x:e,y:t-1}}))}},{key:"left",value:function(){return this._movement((function(e,t){return{x:e-1,y:t}}))}},{key:"step",value:function(){return 0===this.direction?this.right():1===this.direction?this.down():void 0}},{key:"prev",value:function(){return 0===this.direction?this.left():1===this.direction?this.up():void 0}},{key:"_isWordCompleted",value:function(e,t){for(var n=0;n<e.a.length;n++){var r=e.row+(1===t?n:0),s=e.col+(0===t?n:0);if(this.guesses[r][s]!==this.reference[r][s])return{isComplete:!1,x:s,y:r}}return{isComplete:!0}}},{key:"_nextWord",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.currentClue(),n=0===this.direction?this.cluesAcross:this.cluesDown,r=Object.keys(n),s=r.findIndex((function(e){return e===t.cn}));s+e<r.length&&s+e>=0;){var c=n[r[s+e]],i=this._isWordCompleted(c,this.direction);if(!i.isComplete)return this.setCursor(i.x,i.y);s+=e}var o=n[r[s]];if(o===t){this.changeDirection(),o=e>0?this.firstClue():this.lastClue(),this.setCursor(o.col,o.row);var u=this._isWordCompleted(o,this.direction);return u.isComplete?this._nextWord(e):this.setCursor(u.x,u.y)}return this.setCursor(o.col,o.row)}},{key:"nextWord",value:function(){return this._nextWord(1)}},{key:"prevWord",value:function(){return this._nextWord(-1)}},{key:"isBeginningOfWord",value:function(){var e=this.currentClue();return this.cursorX===e.col&&this.cursorY===e.row}},{key:"changeDirection",value:function(){this.direction=(this.direction+1)%2}},{key:"_updateGuess",value:function(e){this.guesses[this.cursorY][this.cursorX]===this.reference[this.cursorY][this.cursorX]&&this.corrects--,this.guesses[this.cursorY][this.cursorX]=e,this.guesses[this.cursorY][this.cursorX]===this.reference[this.cursorY][this.cursorX]&&this.corrects++}},{key:"keypress",value:function(e,t){e=e.toUpperCase();var n=/[A-Z]/.test(e);if("ARROWRIGHT"===e)this.right();else if("ARROWDOWN"===e)this.down();else if("ARROWLEFT"===e)this.left();else if("ARROWUP"===e)this.up();else if("ENTER"===e)this.changeDirection();else if("TAB"===e)t?this.prevWord():this.nextWord();else if("BACKSPACE"===e)this._updateGuess(" "),this.isBeginningOfWord()||this.prev();else if(n&&1===e.length){if(this._updateGuess(e),e===this.reference[this.cursorY][this.cursorX]){var r=this.currentWordRange(),s=r[r.length-1];s[0]===this.cursorX&&s[1]===this.cursorY?this.nextWord():this.step()}}else" "===e&&this.changeDirection();return{x:this.cursorX,y:this.cursorY}}},{key:"currentClue",value:function(){var e=this.cursorX,t=this.cursorY,n=null,r=this.clueMap[t][e];return 0===this.direction?n=this.cluesAcross[r.across.index]:1===this.direction&&(n=this.cluesDown[r.down.index]),n}},{key:"firstClue",value:function(){if(0===this.direction){var e=Object.keys(this.cluesAcross)[0];return this.cluesAcross[e]}if(1===this.direction){var t=Object.keys(this.cluesDown)[0];return this.cluesDown[t]}}},{key:"lastClue",value:function(){if(0===this.direction){var e=Object.keys(this.cluesAcross)[Object.keys(this.cluesAcross).length-1];return this.cluesAcross[e]}if(1===this.direction){var t=Object.keys(this.cluesDown)[Object.keys(this.cluesDown).length-1];return this.cluesDown[t]}}},{key:"currentWordRange",value:function(){var e=this.currentClue();return 0===this.direction?e.a.split("").map((function(t,n){return[e.col+n,e.row]})):1===this.direction?e.a.split("").map((function(t,n){return[e.col,e.row+n]})):void 0}},{key:"currentClueMapping",value:function(){var e=this.cursorX,t=this.cursorY;return this.clueMap[t][e]}},{key:"isOver",value:function(){return this.total===this.corrects}}]),e}(),v=Object(s.createContext)({cursorX:0,cursorY:0,currRange:[],direction:0,onCellClick:function(e,t){},lastGuessed:"",clueMap:{}}),b=function(e){var t=e.content,n=e.reference,c=e.x,i=e.y,o="cell",u=t,a=Object(s.useContext)(v),l=a.onCellClick,h=a.cursorX,d=a.cursorY,f=a.clueMap,j=a.currRange,b=Object(s.useCallback)((function(){null!==t&&l(c,i)}),[l,c,i,t]);null===t&&(o+=" blank",u="\xa0"),c===h&&i===d&&(o+=" selected"),""!==t&&null!==t&&t!==n&&(o+=" incorrect"),j.filter((function(e){return e[0]===c&&e[1]===i})).length>0&&(o+=" in-range");var O=null;return f[i][c]&&f[i][c].across.isStart?O=Object(r.jsx)("span",{className:"indicator",children:f[i][c].across.index}):f[i][c]&&f[i][c].down.isStart&&(O=Object(r.jsx)("span",{className:"indicator",children:f[i][c].down.index})),Object(r.jsxs)("span",{className:o,onClick:b,children:[O,u]})},O=function(e){var t=e.row,n=e.refRow,s=e.y;return Object(r.jsx)("div",{children:t.map((function(e,c){return Object(r.jsx)(b,{content:e,reference:n[c],x:c,y:s},"".concat(t,":").concat(c))}))})},g=function(e){var t=e.game,n=Object(s.useState)(0),c=Object(u.a)(n,2),i=c[0],o=c[1],a=Object(s.useState)(0),l=Object(u.a)(a,2),h=l[0],d=l[1],f=Object(s.useState)([]),j=Object(u.a)(f,2),b=j[0],g=j[1],p=Object(s.useState)(0),x=Object(u.a)(p,2),m=x[0],y=x[1],w=Object(s.useState)(null),k=Object(u.a)(w,2),S=k[0],D=k[1],A=Object(s.useContext)(C),R=A.onCellChanged,W=A.onOver,X=Object(s.useCallback)((function(e){o(e.cursorX),d(e.cursorY),g(e.currentWordRange()),y(e.direction),R()}),[R]),Y=Object(s.useCallback)((function(e,n){t.cursorX===e&&t.cursorY===n&&t.changeDirection(),t.setCursor(e,n),X(t)}),[t,X]),N=Object(s.useCallback)((function(e){return t.keypress(e.key,e.shiftKey),D("".concat(t.cursorX,":").concat(t.cursorY,":").concat(e.key)),X(t),t.isOver()&&W(),e.preventDefault(),!1}),[t,X,W]);return Object(s.useEffect)((function(){X(t)}),[t,X]),Object(s.useEffect)((function(){return document.addEventListener("keydown",N),function(){document.removeEventListener("keydown",N)}}),[N]),Object(r.jsx)("div",{className:"board",children:Object(r.jsx)(v.Provider,{value:{cursorX:i,cursorY:h,currRange:b,direction:m,onCellClick:Y,lastGuessed:S,clueMap:t.clueMap},children:t.guesses.map((function(e,n){return Object(r.jsx)(O,{row:e,refRow:t.reference[n],y:n},n)}))})})};function p(e,t){return"clue-".concat(t,"-").concat(e)}function x(e){return(e.match(/%[0-9a-zA-Z][0-9a-zA-Z]/g)||[]).forEach((function(t){e=e.replaceAll(t,function(e){var t="";try{t=decodeURIComponent(e)}finally{return t}}(t))})),e}var m=function(e){var t=e.game,n=e.direction,c=e.highlighted,i=Object(s.useState)(0),o=Object(u.a)(i,2),a=o[0],l=o[1],h=0===n?t.cluesAcross:t.cluesDown,d=Object.keys(h).map((function(e){return h[e]})),f=Object(s.useContext)(C).currentClueIndices,j=d.reduce((function(e,t){return e[p(t.cn,n)]=Object(s.createRef)(),e}),{}),v=Object(s.useCallback)((function(e){j[e]&&j[e].current.scrollIntoView({behavior:"auto",block:"center"})}),[j]);Object(s.useEffect)((function(){var e="";e=0===n?f.across:f.down,l(e);var t=p(e,n);v(t)}),[f,n,v]);var b=Object(s.useCallback)((function(e){return e.cn===a?c?"selected highlighted":"selected":null}),[a,c]);return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:0===n?"Across":"Down"}),Object(r.jsx)("div",{className:"clue-list",children:d.map((function(e){return Object(r.jsxs)("div",{ref:j[p(e.cn,n)],className:b(e,c),children:[Object(r.jsxs)("span",{children:[e.cn,".\xa0"]}),x(e.c)]},p(e.cn,n))}))},"clues-list-".concat(n))]})},y=function(){var e=Object(s.useState)(0),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(s.useContext)(C),o=i.onPlayPause,a=i.isPlaying,l=i.title,h=function(){o(!a)};return Object(s.useEffect)((function(){if(a){var e=setInterval((function(){c((function(e){return e+1}))}),1e3);return function(){clearInterval(e)}}}),[a,l]),Object(r.jsxs)("div",{className:"gamebar",children:[!a&&Object(r.jsxs)("span",{onClick:h,className:"button item",children:[Object(r.jsx)("i",{className:"fa fa-play",style:{marginRight:5}}),"Resume"]}),a&&Object(r.jsxs)("span",{onClick:h,className:"button item",children:[Object(r.jsx)("i",{className:"fa fa-pause",style:{marginRight:5}}),"Pause"]}),Object(r.jsxs)("span",{className:"item",children:[(n/60>>0).toString().padStart(2,"0"),":",(n%60).toString().padStart(2,"0")]}),Object(r.jsx)("span",{className:"item",children:Object(r.jsx)("h1",{style:{display:"inline"},children:l})})]})},C=Object(s.createContext)({currentClueIndices:{},isPlaying:!0,title:"",onCellChanged:function(){},onPlayPause:function(e){},onOver:function(){}});var w=function(){var e=Object(s.useState)(),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)(),o=Object(u.a)(i,2),a=o[0],h=o[1],d=Object(s.useState)({}),f=Object(u.a)(d,2),v=f[0],b=f[1],O=Object(s.useState)(!0),p=Object(u.a)(O,2),x=p[0],w=p[1],k=Object(s.useState)(!1),S=Object(u.a)(k,2),D=S[0],A=S[1];Object(s.useEffect)((function(){var e=(new Date).toLocaleDateString("en-US").split("/"),t=Object(u.a)(e,3),n=t[0],r=t[1],s=t[2];n=n.padStart(2,"0"),r=r.padStart(2,"0"),s=s.slice(2,4),fetch("".concat("https://cors-anywhere.herokuapp.com/","http://picayune.uclick.com/comics/usaon/data/usaon").concat(s).concat(n).concat(r,"-data.xml"),{origin:"http://example.com"}).then((function(e){return e.text()})).then((function(e){return l.a.parseStringPromise(e)})).then((function(e){var t=new j(e);window.game=t,c(t),h(t.title)}))}),[]);var R=Object(s.useCallback)((function(){if(n){var e=n.currentClueMapping();b({across:e.across.index,down:e.down.index,highlightDirection:n.direction})}}),[n]),W=function(e){w(e)};return Object(r.jsx)("div",{className:"App",children:n&&Object(r.jsx)("div",{children:Object(r.jsxs)(C.Provider,{value:{currentClueIndices:v,isPlaying:x,title:a,onCellChanged:R,onPlayPause:W,onOver:function(){W(!1),A(!0)}},children:[Object(r.jsx)(y,{}),Object(r.jsxs)("div",{className:"game-container ".concat(x?"playing":"paused"),children:[Object(r.jsxs)("div",{className:"game-area",children:[Object(r.jsx)(g,{game:n}),Object(r.jsxs)("div",{className:"clues-area",children:[Object(r.jsx)(m,{direction:0,highlighted:0===v.highlightDirection,game:n}),Object(r.jsx)(m,{direction:1,highlighted:1===v.highlightDirection,game:n})]})]}),Object(r.jsx)("div",{className:"veil",children:D&&Object(r.jsx)("div",{children:"Congrats!"})})]})]})})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,87)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),s(e),c(e),i(e)}))};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(w,{})}),document.getElementById("root")),k()}},[[86,1,2]]]);
//# sourceMappingURL=main.8fda5287.chunk.js.map